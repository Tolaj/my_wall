<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Control</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            background: transparent;
            font-family: "Segoe UI", Roboto, Arial, sans-serif;
            -webkit-app-region: no-drag;
        }

        #btn {
            -webkit-app-region: no-drag;
        }

        #movBtn {
            -webkit-app-region: drag;
        }

        #settBtn {
            -webkit-app-region: no-drag;
        }

        #closeBtn {
            -webkit-app-region: no-drag;
        }
    </style>
</head>

<body class="w-fit h-fit">
    <div class="inline-flex items-center gap-2">
        <!-- Main button -->
        <div id="btn-area-id" class="btn-area inline-flex items-center gap-2">
            <div id="btn"
                class="bg-[#3c3c3b] bg-opacity-80 border border-white/30 text-white px-4 py-2 rounded-full text-base cursor-pointer backdrop-blur-md select-none hover:bg-black hover:border-white/40 transition-all duration-200">
                ＋ Add
            </div>
            <div class="flex flex-col items-center justify-center gap-1">
                <svg id="closeBtn" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
                    class="size-5 fill-white hover:fill-red-500 hover:cursor-pointer">
                    <path fill-rule="evenodd"
                        d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z"
                        clip-rule="evenodd" />
                </svg>

                <svg id="settBtn" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"
                    class="size-4 fill-white hover:cursor-pointer hover:fill-blue-400">
                    <path fill-rule="evenodd"
                        d="M6.455 1.45A.5.5 0 0 1 6.952 1h2.096a.5.5 0 0 1 .497.45l.186 1.858a4.996 4.996 0 0 1 1.466.848l1.703-.769a.5.5 0 0 1 .639.206l1.047 1.814a.5.5 0 0 1-.14.656l-1.517 1.09a5.026 5.026 0 0 1 0 1.694l1.516 1.09a.5.5 0 0 1 .141.656l-1.047 1.814a.5.5 0 0 1-.639.206l-1.703-.768c-.433.36-.928.649-1.466.847l-.186 1.858a.5.5 0 0 1-.497.45H6.952a.5.5 0 0 1-.497-.45l-.186-1.858a4.993 4.993 0 0 1-1.466-.848l-1.703.769a.5.5 0 0 1-.639-.206l-1.047-1.814a.5.5 0 0 1 .14-.656l1.517-1.09a5.033 5.033 0 0 1 0-1.694l-1.516-1.09a.5.5 0 0 1-.141-.656L2.46 3.593a.5.5 0 0 1 .639-.206l1.703.769c.433-.36.928-.65 1.466-.848l.186-1.858Zm-.177 7.567-.022-.037a2 2 0 0 1 3.466-1.997l.022.037a2 2 0 0 1-3.466 1.997Z"
                        clip-rule="evenodd" />
                </svg>
                <svg id="movBtn" class="size-4 text-white hover:cursor-pointer hover:fill-blue-400" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="5 9 2 12 5 15" />
                    <polyline points="9 5 12 2 15 5" />
                    <polyline points="15 19 12 22 9 19" />
                    <polyline points="19 9 22 12 19 15" />
                    <line x1="2" y1="12" x2="22" y2="12" />
                    <line x1="12" y1="2" x2="12" y2="22" />
                </svg>
            </div>
        </div>
    </div>

    <script>
        const { ipcRenderer } = require("electron");
        const btn = document.getElementById("btn");
        const closeBtn = document.getElementById("closeBtn");
        const settBtn = document.getElementById("settBtn");

        let editing = false;

        btn.addEventListener("click", () => {
            editing = !editing;
            ipcRenderer.send("toggle-edit", editing);
            updateUI();
        });

        // Listen to updates from main
        ipcRenderer.on("editing-changed", (event, isEditing) => {
            editing = isEditing;
            updateUI();
        });

        function updateUI() {
            btn.textContent = editing ? "✓ Done" : "＋ Add";
        }

        closeBtn.addEventListener("click", () => {
            if (confirm("Are you sure you want to close the application?")) {
                ipcRenderer.send("close-app");
            }
        });

        // Open settings window
        settBtn.addEventListener("click", () => {
            ipcRenderer.send('open-settings-window');
        });
    </script>
</body>

</html>